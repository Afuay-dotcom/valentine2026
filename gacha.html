<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nunt's Gacha üé≤</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Kanit:wght@300;600&display=swap');
        
        body {
            font-family: 'Kanit', sans-serif;
            background-color: #ffe6f2;
            background-image: radial-gradient(#ffc2d1 15%, transparent 16%);
            background-size: 40px 40px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden;
            user-select: none;
        }

        h1 {
            color: #d63384;
            text-shadow: 2px 2px white;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .gacha-machine {
            position: relative;
            width: 300px;
            height: 300px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 0 #ff8fab, 0 20px 20px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 8rem;
            cursor: pointer;
            transition: transform 0.1s;
            border: 5px solid #ff8fab;
        }

        .gacha-machine:active {
            transform: scale(0.95) translateY(5px);
            box-shadow: 0 5px 0 #ff8fab, 0 10px 10px rgba(0,0,0,0.2);
        }

        .shake { animation: shake 0.5s; }

        .btn-group {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .btn-draw {
            background: linear-gradient(45deg, #ff69b4, #ff8fab);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.5rem;
            border-radius: 50px;
            font-family: 'Kanit', sans-serif;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(255, 105, 180, 0.4);
            transition: 0.2s;
        }

        .btn-history {
            background: white;
            color: #d63384;
            border: 2px solid #ff8fab;
            padding: 15px 20px;
            font-size: 1.2rem;
            border-radius: 50px;
            cursor: pointer;
            font-family: 'Kanit', sans-serif;
            transition: 0.2s;
        }

        .btn-draw:hover, .btn-history:hover { transform: scale(1.05); }

        /* Modal ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ */
        .modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7);
            align-items: center;
            justify-content: center;
            z-index: 100;
        }

        .card-result {
            background: white;
            width: 300px;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 5px solid #ddd;
            position: relative;
        }

        /* Modal ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥ */
        .history-card {
            background: white;
            width: 85%;
            max-width: 400px;
            height: 60vh;
            padding: 20px;
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            animation: slideUp 0.3s;
        }

        .history-list {
            flex: 1;
            overflow-y: auto;
            text-align: left;
            margin-top: 10px;
            border: 1px solid #eee;
            border-radius: 10px;
            padding: 10px;
        }

        .history-item {
            padding: 10px;
            border-bottom: 1px solid #f0f0f0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .history-item:last-child { border-bottom: none; }
        
        .h-time { font-size: 0.8rem; color: #aaa; min-width: 50px; }
        .h-name { font-weight: 500; color: #555; }
        
        .badge-ssr { background: #ff00ff; color: white; padding: 2px 6px; border-radius: 4px; font-size: 0.7rem; }
        .badge-sr { background: #ffd700; color: white; padding: 2px 6px; border-radius: 4px; font-size: 0.7rem; }
        .badge-salt { background: #aaa; color: white; padding: 2px 6px; border-radius: 4px; font-size: 0.7rem; }

        /* ‡∏™‡∏µ‡∏Ç‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Å‡∏•‡∏∑‡∏≠ */
        .rarity-n { border-color: #a0a0a0; }
        .rarity-sr { border-color: #ffd700; box-shadow: 0 0 20px #ffd700; }
        .rarity-ssr { border-color: #ff00ff; box-shadow: 0 0 30px #ff00ff; }

        .item-icon { font-size: 5rem; display: block; margin-bottom: 10px; }
        .item-name { font-size: 1.5rem; font-weight: bold; margin-bottom: 10px; }
        .item-desc { color: #666; font-size: 0.9rem; margin-bottom: 20px; }

        .close-btn {
            background: #444; color: white; border: none; padding: 10px 20px;
            border-radius: 10px; cursor: pointer; font-family: 'Kanit', sans-serif;
            margin-top: 10px;
        }

        .clear-btn {
            background: #ffcccc; color: #d63384; border: none; padding: 8px 15px;
            border-radius: 5px; cursor: pointer; font-size: 0.9rem; margin-top: 10px;
        }
        
        .ssr-text { color: #ff00ff; animation: rainbow 2s infinite; }
        .home-link { margin-top: 20px; text-decoration: none; color: #d63384; font-weight: bold; }

        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-1deg); }
            50% { transform: translate(-1px, 2px) rotate(-1deg); }
            100% { transform: translate(1px, -2px) rotate(-1deg); }
        }
        @keyframes popIn { 0% { transform: scale(0); } 100% { transform: scale(1); } }
        @keyframes slideUp { 0% { transform: translateY(100%); } 100% { transform: translateY(0); } }
        @keyframes rainbow { 0% {color: red;} 50% {color: blue;} 100% {color: violet;} }
    </style>
</head>
<body>

    <h1>üîÆ ‡∏™‡∏∏‡πà‡∏°‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç (Gacha)</h1>
    <div style="text-align:center; color:#888; margin-bottom:20px;">
        Rate: SSR 5% | SR 25% | Salt 70% <br>
        (‡∏ß‡∏±‡∏î‡∏î‡∏ß‡∏á‡∏Å‡∏±‡∏ô‡∏´‡∏ô‡πà‡∏≠‡∏¢‡∏¢‡∏¢!)
    </div>

    <div class="gacha-machine" id="machine" onclick="drawGacha()">üéÅ</div>

    <div class="btn-group">
        <button class="btn-history" onclick="openHistory()">üìú ‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤</button>
        <button class="btn-draw" onclick="drawGacha()">‡∏Å‡∏î‡∏™‡∏∏‡πà‡∏°</button>
    </div>
    
    <a href="index.html" class="home-link">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>

    <div id="resultModal" class="modal">
        <div id="resultCard" class="card-result">
            <div id="itemIcon" class="item-icon"></div>
            <div id="itemName" class="item-name"></div>
            <div id="itemDesc" class="item-desc"></div>
            <button class="close-btn" onclick="closeModal()">‡∏ï‡∏Å‡∏•‡∏á</button>
        </div>
    </div>

    <div id="historyModal" class="modal">
        <div class="history-card">
            <h2 style="margin:0; color:#d63384;">üì¶ ‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</h2>
            <div class="history-list" id="historyList">
                </div>
            <div style="display:flex; justify-content:space-between;">
                <button class="clear-btn" onclick="clearHistory()">‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</button>
                <button class="close-btn" onclick="closeHistory()">‡∏õ‡∏¥‡∏î</button>
            </div>
        </div>
    </div>

    <script>
        // ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°)
        const saltItems = [
            { icon: "üßÇ", name: "‡πÄ‡∏Å‡∏•‡∏∑‡∏≠‡πÅ‡∏Å‡∏á", desc: "‡πÄ‡∏Ñ‡πá‡∏°‡∏õ‡∏µ‡πã‡πÄ‡∏•‡∏¢... ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏ô‡∏∞‡∏à‡πä‡∏∞" },
            { icon: "üí®", name: "‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏ò‡∏≤‡∏ï‡∏∏", desc: "‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤‡∏ï‡∏±‡∏á‡∏Ñ‡πå‡∏ä‡πà‡∏ß‡∏á‡∏™‡∏¥‡πâ‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô" },
            { icon: "üëª", name: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤", desc: "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô..." },
            { icon: "ü•î", name: "‡∏°‡∏±‡∏ô‡∏ù‡∏£‡∏±‡πà‡∏á‡∏ó‡∏≠‡∏î", desc: "‡∏Å‡∏¥‡∏ô‡πÅ‡∏Å‡πâ‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î‡πÑ‡∏õ‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏∞" },
            { icon: "üßª", name: "‡∏ó‡∏¥‡∏ä‡∏ä‡∏π‡πà 1 ‡πÅ‡∏ú‡πà‡∏ô", desc: "‡πÄ‡∏≠‡∏≤‡πÑ‡∏ß‡πâ‡πÄ‡∏ä‡πá‡∏î‡∏ô‡πâ‡∏≥‡∏ï‡∏≤... ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡πÉ‡∏´‡∏ç‡πà" },
            { icon: "üß±", name: "‡∏≠‡∏¥‡∏ê‡∏Å‡πâ‡∏≠‡∏ô‡∏ô‡∏∂‡∏á", desc: "‡πÄ‡∏≠‡∏≤‡πÑ‡∏õ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡πâ‡∏≤‡∏ô‡∏ô‡∏∞" },
            { icon: "ü•¨", name: "‡∏ú‡∏±‡∏Å‡∏ä‡∏µ‡πÇ‡∏£‡∏¢‡∏´‡∏ô‡πâ‡∏≤", desc: "‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• ‡πÅ‡∏ï‡πà‡πÑ‡∏î‡πâ‡∏ú‡∏±‡∏Å" },
            { icon: "üìÑ", name: "‡∏ö‡∏¥‡∏•‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü", desc: "‡∏≠‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏ü‡∏¥‡∏™‡∏ó‡πå‡∏ù‡∏≤‡∏Å‡∏à‡πà‡∏≤‡∏¢‡∏´‡∏ô‡πà‡∏≠‡∏¢" }
        ];

        const srItems = [
            { icon: "üõå", name: "‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏ô‡∏≠‡∏ô‡πÄ‡∏£‡πá‡∏ß", desc: "‡∏Ñ‡∏∑‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏ü‡∏¥‡∏™‡∏ó‡πå‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏î‡πá‡∏Å‡∏î‡∏µ ‡∏£‡∏µ‡∏ö‡πÑ‡∏õ‡∏ô‡∏≠‡∏ô‡πÑ‡∏ß‡πÜ ‡πÑ‡∏°‡πà‡∏î‡∏∑‡πâ‡∏≠!" },
            { icon: "üòá", name: "‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡∏á‡∏î‡πÇ‡∏ß‡∏¢‡∏ß‡∏≤‡∏¢", desc: "1 ‡∏ß‡∏±‡∏ô‡πÄ‡∏ï‡πá‡∏°! ‡πÄ‡∏ü‡∏¥‡∏™‡∏ó‡πå‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ö‡πà‡∏ô ‡πÑ‡∏°‡πà‡∏ß‡∏µ‡∏ô ‡∏¢‡∏≠‡∏°‡∏Ñ‡∏∏‡∏ì‡∏ô‡∏±‡∏ô‡∏ï‡πå‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á" }
        ];

        const ssrItem = { 
            icon: "üëë", name: "‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡πÉ‡∏à‡∏ô‡∏±‡∏ô‡∏ï‡πå 1 ‡∏ß‡∏±‡∏ô", 
            desc: "SSR Item! ‡∏™‡∏±‡πà‡∏á‡∏≠‡∏∞‡πÑ‡∏£‡∏Å‡πá‡πÑ‡∏î‡πâ‡πÄ‡∏ü‡∏¥‡∏™‡∏ó‡πå‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏´‡∏°‡∏î (‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 1 ‡∏ß‡∏±‡∏ô) *‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß*" 
        };

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏∏‡πà‡∏° (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°)
        function drawGacha() {
            const machine = document.getElementById('machine');
            machine.classList.add('shake');
            setTimeout(() => {
                machine.classList.remove('shake');
                showResult();
            }, 500);
        }

        function showResult() {
            const chance = Math.random() * 100;
            let result;
            let rarityClass;
            let badge;

            if (chance < 5) { 
                result = ssrItem; rarityClass = 'rarity-ssr'; badge = 'SSR';
            } else if (chance < 30) { 
                result = srItems[Math.floor(Math.random() * srItems.length)]; rarityClass = 'rarity-sr'; badge = 'SR';
            } else {
                result = saltItems[Math.floor(Math.random() * saltItems.length)]; rarityClass = 'rarity-n'; badge = 'Salt';
            }

            // --- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°: ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á ---
            saveToHistory(result.name, result.icon, badge);

            // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
            const card = document.getElementById('resultCard');
            card.className = 'card-result ' + rarityClass;
            document.getElementById('itemIcon').innerText = result.icon;
            
            const nameEl = document.getElementById('itemName');
            nameEl.innerText = result.name;
            if (rarityClass === 'rarity-ssr') nameEl.classList.add('ssr-text');
            else nameEl.classList.remove('ssr-text');

            document.getElementById('itemDesc').innerText = result.desc;
            document.getElementById('resultModal').style.display = 'flex';
        }

        // --- ‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥ (Local Storage) ---
        function saveToHistory(name, icon, rarity) {
            // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤‡∏≠‡∏≠‡∏Å‡∏°‡∏≤ (‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏´‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏≤‡πÄ‡∏£‡∏¢‡πå‡∏ß‡πà‡∏≤‡∏á)
            let history = JSON.parse(localStorage.getItem('nunt_gacha_history')) || [];
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà
            const newItem = {
                name: name,
                icon: icon,
                rarity: rarity,
                time: new Date().toLocaleTimeString('th-TH', {hour: '2-digit', minute:'2-digit'})
            };

            // ‡πÉ‡∏™‡πà‡πÑ‡∏ß‡πâ‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏∏‡∏î (‡∏≠‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏ô)
            history.unshift(newItem);

            // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏•‡∏±‡∏ö‡∏•‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á
            localStorage.setItem('nunt_gacha_history', JSON.stringify(history));
        }

        function openHistory() {
            const listEl = document.getElementById('historyList');
            listEl.innerHTML = ""; // ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏Ç‡∏≠‡∏á‡πÄ‡∏Å‡πà‡∏≤
            
            const history = JSON.parse(localStorage.getItem('nunt_gacha_history')) || [];

            if (history.length === 0) {
                listEl.innerHTML = "<div style='text-align:center; margin-top:50px; color:#aaa;'>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡πÄ‡∏•‡∏¢...<br>‡πÑ‡∏õ‡∏™‡∏∏‡πà‡∏°‡∏Å‡πà‡∏≠‡∏ô‡∏™‡∏¥!</div>";
            } else {
                history.forEach(item => {
                    let badgeClass = item.rarity === 'SSR' ? 'badge-ssr' : (item.rarity === 'SR' ? 'badge-sr' : 'badge-salt');
                    
                    listEl.innerHTML += `
                        <div class="history-item">
                            <span class="h-time">${item.time}</span>
                            <span class="${badgeClass}">${item.rarity}</span>
                            <span style="font-size:1.2rem;">${item.icon}</span>
                            <span class="h-name">${item.name}</span>
                        </div>
                    `;
                });
            }
            document.getElementById('historyModal').style.display = 'flex';
        }

        function clearHistory() {
            if(confirm("‡∏à‡∏∞‡∏•‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏£‡∏¥‡∏á‡∏´‡∏£‡∏≠? ‡∏Ç‡∏≠‡∏á‡∏´‡∏≤‡∏¢‡∏´‡∏°‡∏î‡∏ô‡∏∞!")) {
                localStorage.removeItem('nunt_gacha_history');
                openHistory(); // ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥
            }
        }

        function closeModal() { document.getElementById('resultModal').style.display = 'none'; }
        function closeHistory() { document.getElementById('historyModal').style.display = 'none'; }
    </script>

</body>
</html>
